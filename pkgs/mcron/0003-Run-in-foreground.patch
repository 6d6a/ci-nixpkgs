From f65ce913f5401c3646e4e694e71899ef5deaf7d5 Mon Sep 17 00:00:00 2001
From: Oleg Pykhalov <go.wigust@gmail.com>
Date: Tue, 3 Sep 2019 20:40:24 +0300
Subject: [PATCH 3/3] Run in foreground

---
 src/mcron/scripts/cron.scm | 11 -----------
 1 file changed, 11 deletions(-)

diff --git a/src/mcron/scripts/cron.scm b/src/mcron/scripts/cron.scm
index 1a97fdf..abeddb7 100644
--- a/src/mcron/scripts/cron.scm
+++ b/src/mcron/scripts/cron.scm
@@ -157,17 +157,6 @@ option.\n")
      (else
       (%process-files (option-ref opts 'schedule #f)
                       (option-ref opts 'noetc #f))
-      (cond ((option-ref opts 'schedule #f) ;display jobs schedule
-             => (λ (count)
-                  (display-schedule (max 1 (string->number count)))
-                  (exit 0)))
-            (else (case (primitive-fork) ;run the daemon
-                    ((0)
-                     (setsid)
-                     ;; we can now write the PID file.
-                     (with-output-to-file config-pid-file
-                       (λ () (display (getpid)) (newline))))
-                    (else (exit 0)))))
       ;; Forever execute the 'run-job-loop', and when it drops out (can
       ;; only be because a message has come in on the socket) we
       ;; process the socket request before restarting the loop again.
-- 
2.23.0

